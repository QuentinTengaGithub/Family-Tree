{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { getAuth, createUserWithEmailAndPassword } from \"firebase/auth\";\nimport { collection, doc, getDocs, query, setDoc, where } from \"firebase/firestore\";\nimport { db } from \"../firebaseConfig\";\nexport default {\n  data() {\n    return {\n      name: '',\n      email: '',\n      password: '',\n      confirmPassword: ''\n    };\n  },\n  methods: {\n    async createAccount() {\n      if (this.password !== this.confirmPassword) {\n        alert(\"Passwords do not match.\");\n        return;\n      }\n\n      // Check for name uniqueness with a query\n      const q = query(collection(db, \"users\"), where(\"name\", \"==\", this.name));\n      const querySnapshot = await getDocs(q);\n      if (!querySnapshot.empty) {\n        alert(\"This name is already taken. Please choose another one.\");\n        return;\n      }\n      const auth = getAuth();\n      createUserWithEmailAndPassword(auth, this.email, this.password).then(userCredential => {\n        const user = userCredential.user;\n        // Revert to using user.uid as the document ID\n        const userRef = doc(db, \"users\", user.uid);\n        setDoc(userRef, {\n          uid: user.uid,\n          email: user.email,\n          name: this.name,\n          role: user.email === 'quentinritt94@gmail.com' ? 'superadmin' : 'user'\n        });\n        this.$router.push('/sign-in');\n      }).catch(error => {\n        alert(error.message);\n      });\n    },\n    changeTab(tab) {\n      this.$router.push('/' + tab.toLowerCase());\n    }\n  },\n  computed: {\n    darkMode() {\n      return this.$store.state.darkMode;\n    }\n  }\n};","map":{"version":3,"names":["getAuth","createUserWithEmailAndPassword","collection","doc","getDocs","query","setDoc","where","db","data","name","email","password","confirmPassword","methods","createAccount","alert","q","querySnapshot","empty","auth","then","userCredential","user","userRef","uid","role","$router","push","catch","error","message","changeTab","tab","toLowerCase","computed","darkMode","$store","state"],"sources":["/Users/quentin/Family-Tree/src/views/SignUp.vue"],"sourcesContent":["<template>\n    <div class=\"content\">\n        <p class=\"title\">Sign Up</p>\n        <form @submit.prevent=\"createAccount\">\n            <div class=\"form_input_container\">\n                <p class=\"form_text\" :class=\"{ dark: darkMode }\">Name</p>\n                <div class=\"form_input\">\n                    <input \n                        style=\"padding-left:10px\" \n                        type=\"text\" \n                        name=\"name\" \n                        id=\"name\" \n                        v-model=\"name\" \n                        class=\"form_input\"\n                        placeholder=\"Enter name\"\n                        :class=\"{ dark: darkMode }\"\n                    >\n                </div>\n            </div>\n            <div class=\"form_input_container\">\n                <p class=\"form_text\" :class=\"{ dark: darkMode }\">Email</p>\n                <div class=\"form_input\">\n                    <input \n                        style=\"padding-left:10px\" \n                        type=\"email\" \n                        name=\"email\" \n                        id=\"email\" \n                        v-model=\"email\" \n                        class=\"form_input\"\n                        placeholder=\"Enter email adress\"\n                        :class=\"{ dark: darkMode }\"\n                    >\n                </div>\n            </div>\n            <div class=\"form_input_container\">\n                <p class=\"form_text\" :class=\"{ dark: darkMode }\">Password</p>\n                <div class=\"form_input\">\n                    <input \n                        style=\"padding-left:10px\" \n                        type=\"password\" \n                        name=\"password\" \n                        id=\"password\" \n                        v-model=\"password\" \n                        class=\"form_input\"\n                        placeholder=\"Enter password\"\n                        :class=\"{ dark: darkMode }\"\n                    >\n                </div>\n            </div>\n            <div class=\"form_input_container\">\n                <p class=\"form_text\" :class=\"{ dark: darkMode }\">Confirm password</p>\n                <div class=\"form_input\">\n                    <input \n                        style=\"padding-left:10px\" \n                        type=\"password\" \n                        name=\"confirmPassword\" \n                        id=\"confirmPassword\" \n                        v-model=\"confirmPassword\" \n                        class=\"form_input\"\n                        placeholder=\"Confirm password\"\n                        :class=\"{ dark: darkMode }\"\n                    >\n                </div>\n            </div>\n            <p><input class=\"button\" type=\"submit\" value=\"Create Account\"></p>\n            <p class=\"redirect-text\" @click=\"changeTab('Sign-In')\">Already have an account ?</p>\n        </form>\n    </div>\n</template>\n\n<script>\nimport { getAuth, createUserWithEmailAndPassword } from \"firebase/auth\";\nimport { collection, doc, getDocs, query, setDoc, where } from \"firebase/firestore\";\nimport { db } from \"../firebaseConfig\";\n\nexport default {\n    data() {\n        return {\n            name: '',\n            email: '',\n            password: '',\n            confirmPassword: ''\n        }\n    },\n    methods: {\n        async createAccount() {\n            if (this.password !== this.confirmPassword) {\n                alert(\"Passwords do not match.\");\n                return;\n            }\n\n            // Check for name uniqueness with a query\n            const q = query(collection(db, \"users\"), where(\"name\", \"==\", this.name));\n            const querySnapshot = await getDocs(q);\n            if (!querySnapshot.empty) {\n                alert(\"This name is already taken. Please choose another one.\");\n                return;\n            }\n\n            const auth = getAuth();\n            createUserWithEmailAndPassword(auth, this.email, this.password)\n                .then((userCredential) => {\n                    const user = userCredential.user;\n                    // Revert to using user.uid as the document ID\n                    const userRef = doc(db, \"users\", user.uid);\n                    setDoc(userRef, {\n                        uid: user.uid,\n                        email: user.email,\n                        name: this.name,\n                        role: user.email === 'quentinritt94@gmail.com' ? 'superadmin' : 'user'\n                    });\n                    this.$router.push('/sign-in');\n                })\n                .catch(error => {\n                    alert(error.message);\n                });\n        },\n        changeTab(tab) {\n            this.$router.push('/' + tab.toLowerCase());\n        }\n    },\n    computed: {\n        darkMode() {\n            return this.$store.state.darkMode;\n        }\n    }\n}\n</script>\n\n<style>\n</style>"],"mappings":";AAuEA,SAASA,OAAO,EAAEC,8BAA6B,QAAS,eAAe;AACvE,SAASC,UAAU,EAAEC,GAAG,EAAEC,OAAO,EAAEC,KAAK,EAAEC,MAAM,EAAEC,KAAI,QAAS,oBAAoB;AACnF,SAASC,EAAC,QAAS,mBAAmB;AAEtC,eAAe;EACXC,IAAIA,CAAA,EAAG;IACH,OAAO;MACHC,IAAI,EAAE,EAAE;MACRC,KAAK,EAAE,EAAE;MACTC,QAAQ,EAAE,EAAE;MACZC,eAAe,EAAE;IACrB;EACJ,CAAC;EACDC,OAAO,EAAE;IACL,MAAMC,aAAaA,CAAA,EAAG;MAClB,IAAI,IAAI,CAACH,QAAO,KAAM,IAAI,CAACC,eAAe,EAAE;QACxCG,KAAK,CAAC,yBAAyB,CAAC;QAChC;MACJ;;MAEA;MACA,MAAMC,CAAA,GAAIZ,KAAK,CAACH,UAAU,CAACM,EAAE,EAAE,OAAO,CAAC,EAAED,KAAK,CAAC,MAAM,EAAE,IAAI,EAAE,IAAI,CAACG,IAAI,CAAC,CAAC;MACxE,MAAMQ,aAAY,GAAI,MAAMd,OAAO,CAACa,CAAC,CAAC;MACtC,IAAI,CAACC,aAAa,CAACC,KAAK,EAAE;QACtBH,KAAK,CAAC,wDAAwD,CAAC;QAC/D;MACJ;MAEA,MAAMI,IAAG,GAAIpB,OAAO,CAAC,CAAC;MACtBC,8BAA8B,CAACmB,IAAI,EAAE,IAAI,CAACT,KAAK,EAAE,IAAI,CAACC,QAAQ,EACzDS,IAAI,CAAEC,cAAc,IAAK;QACtB,MAAMC,IAAG,GAAID,cAAc,CAACC,IAAI;QAChC;QACA,MAAMC,OAAM,GAAIrB,GAAG,CAACK,EAAE,EAAE,OAAO,EAAEe,IAAI,CAACE,GAAG,CAAC;QAC1CnB,MAAM,CAACkB,OAAO,EAAE;UACZC,GAAG,EAAEF,IAAI,CAACE,GAAG;UACbd,KAAK,EAAEY,IAAI,CAACZ,KAAK;UACjBD,IAAI,EAAE,IAAI,CAACA,IAAI;UACfgB,IAAI,EAAEH,IAAI,CAACZ,KAAI,KAAM,yBAAwB,GAAI,YAAW,GAAI;QACpE,CAAC,CAAC;QACF,IAAI,CAACgB,OAAO,CAACC,IAAI,CAAC,UAAU,CAAC;MACjC,CAAC,EACAC,KAAK,CAACC,KAAI,IAAK;QACZd,KAAK,CAACc,KAAK,CAACC,OAAO,CAAC;MACxB,CAAC,CAAC;IACV,CAAC;IACDC,SAASA,CAACC,GAAG,EAAE;MACX,IAAI,CAACN,OAAO,CAACC,IAAI,CAAC,GAAE,GAAIK,GAAG,CAACC,WAAW,CAAC,CAAC,CAAC;IAC9C;EACJ,CAAC;EACDC,QAAQ,EAAE;IACNC,QAAQA,CAAA,EAAG;MACP,OAAO,IAAI,CAACC,MAAM,CAACC,KAAK,CAACF,QAAQ;IACrC;EACJ;AACJ"},"metadata":{},"sourceType":"module","externalDependencies":[]}