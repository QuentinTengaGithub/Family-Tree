{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { getAuth, signInWithEmailAndPassword, signOut } from \"firebase/auth\";\nimport { doc, getDoc } from \"firebase/firestore\";\nimport { db } from \"../firebaseConfig\";\nexport default {\n  data() {\n    return {\n      email: '',\n      password: '',\n      errorMessage: '',\n      errorTimeout: null\n    };\n  },\n  methods: {\n    async login() {\n      this.errorMessage = '';\n      if (this.errorTimeout) {\n        clearTimeout(this.errorTimeout);\n      }\n      const auth = getAuth();\n      try {\n        const userCredential = await signInWithEmailAndPassword(auth, this.email, this.password);\n        const user = userCredential.user;\n        const userDocRef = doc(db, \"users\", user.uid);\n        const userDocSnap = await getDoc(userDocRef);\n        if (!userDocSnap.exists()) {\n          await signOut(auth);\n          this.showError(\"Unrecognized credentials\");\n        } else {\n          this.$store.dispatch('fetchMembers');\n          this.$router.push('/home');\n        }\n      } catch (error) {\n        // For security, show a generic message for most login errors\n        this.showError(\"Unrecognized credentials\");\n      }\n    },\n    showError(message) {\n      this.errorMessage = message;\n      this.errorTimeout = setTimeout(() => {\n        this.errorMessage = '';\n      }, 5000);\n    },\n    changeTab(tab) {\n      this.$router.push('/' + tab.toLowerCase());\n    }\n  },\n  computed: {\n    darkMode() {\n      return this.$store.state.darkMode;\n    }\n  }\n};","map":{"version":3,"names":["getAuth","signInWithEmailAndPassword","signOut","doc","getDoc","db","data","email","password","errorMessage","errorTimeout","methods","login","clearTimeout","auth","userCredential","user","userDocRef","uid","userDocSnap","exists","showError","$store","dispatch","$router","push","error","message","setTimeout","changeTab","tab","toLowerCase","computed","darkMode","state"],"sources":["/Users/quentin/Family-Tree/src/views/SignIn.vue"],"sourcesContent":["<template>\n    <div class=\"content\">\n        <p class=\"title\">Sign In</p>\n        <form @submit.prevent=\"login\">\n            <div class=\"form_input_container\">\n                <p class=\"form_text\" :class=\"{ dark: darkMode }\">Email</p>\n                <div class=\"form_input\">\n                    <input \n                        style=\"padding-left:10px\" \n                        type=\"email\" \n                        name=\"email\" \n                        id=\"email\" \n                        v-model=\"email\" \n                        class=\"form_input\"\n                        placeholder=\"Enter email adress\"\n                        :class=\"{ dark: darkMode }\"\n                    >\n                </div>\n            </div>\n            <div class=\"form_input_container\">\n                <p class=\"form_text\" :class=\"{ dark: darkMode }\">Password</p>\n                <div class=\"form_input\">\n                    <input \n                        style=\"padding-left:10px\" \n                        type=\"password\" \n                        name=\"password\" \n                        id=\"password\" \n                        v-model=\"password\" \n                        class=\"form_input\"\n                        placeholder=\"Enter password\"\n                        :class=\"{ dark: darkMode }\"\n                    >\n                </div>\n            </div>\n            <p><input class=\"button\" type=\"submit\" value=\"Log In\"></p>\n            <p class=\"redirect-text\" @click=\"changeTab('Sign-Up')\">Don't have an account ?</p>\n            <div class=\"error-container\">\n                <p :class=\"['error-message', { 'visible': errorMessage }]\" v-if=\"errorMessage\">{{ errorMessage }}</p>\n            </div>\n        </form>\n    </div>\n</template>\n\n<script>\nimport { getAuth, signInWithEmailAndPassword, signOut } from \"firebase/auth\";\nimport { doc, getDoc } from \"firebase/firestore\";\nimport { db } from \"../firebaseConfig\";\n\nexport default {\n    data() {\n        return {\n            email: '',\n            password: '',\n            errorMessage: '',\n            errorTimeout: null\n        }\n    },\n    methods: {\n        async login() {\n            this.errorMessage = '';\n            if (this.errorTimeout) {\n                clearTimeout(this.errorTimeout);\n            }\n\n            const auth = getAuth();\n            try {\n                const userCredential = await signInWithEmailAndPassword(auth, this.email, this.password);\n                const user = userCredential.user;\n\n                const userDocRef = doc(db, \"users\", user.uid);\n                const userDocSnap = await getDoc(userDocRef);\n\n                if (!userDocSnap.exists()) {\n                    await signOut(auth);\n                    this.showError(\"Unrecognized credentials\");\n                } else {\n                    this.$store.dispatch('fetchMembers');\n                    this.$router.push('/home');\n                }\n            } catch (error) {\n                // For security, show a generic message for most login errors\n                this.showError(\"Unrecognized credentials\");\n            }\n        },\n        showError(message) {\n            this.errorMessage = message;\n            this.errorTimeout = setTimeout(() => {\n                this.errorMessage = '';\n            }, 5000);\n        },\n        changeTab(tab) {\n            this.$router.push('/' + tab.toLowerCase());\n        }\n    },\n    computed: {\n        darkMode() {\n      return this.$store.state.darkMode;\n    }\n    }\n}\n</script>\n\n<style>\n.redirect-text {\n    font-weight:bold;\n    cursor:pointer;\n}\n\n.redirect-text:hover {\n    text-decoration: underline;\n}\n\n.error-container {\n    height: 20px; /* Reserve space to prevent layout shift */\n    margin-top: 10px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n\n.error-message {\n    color: red;\n    font-weight: bold;\n    opacity: 0;\n    visibility: hidden;\n    transition: opacity 0.5s ease, visibility 0s linear 0.5s;\n}\n\n.error-message.visible {\n    opacity: 1;\n    visibility: visible;\n    transition: opacity 0.5s ease;\n}\n</style>"],"mappings":";AA4CA,SAASA,OAAO,EAAEC,0BAA0B,EAAEC,OAAM,QAAS,eAAe;AAC5E,SAASC,GAAG,EAAEC,MAAK,QAAS,oBAAoB;AAChD,SAASC,EAAC,QAAS,mBAAmB;AAEtC,eAAe;EACXC,IAAIA,CAAA,EAAG;IACH,OAAO;MACHC,KAAK,EAAE,EAAE;MACTC,QAAQ,EAAE,EAAE;MACZC,YAAY,EAAE,EAAE;MAChBC,YAAY,EAAE;IAClB;EACJ,CAAC;EACDC,OAAO,EAAE;IACL,MAAMC,KAAKA,CAAA,EAAG;MACV,IAAI,CAACH,YAAW,GAAI,EAAE;MACtB,IAAI,IAAI,CAACC,YAAY,EAAE;QACnBG,YAAY,CAAC,IAAI,CAACH,YAAY,CAAC;MACnC;MAEA,MAAMI,IAAG,GAAId,OAAO,CAAC,CAAC;MACtB,IAAI;QACA,MAAMe,cAAa,GAAI,MAAMd,0BAA0B,CAACa,IAAI,EAAE,IAAI,CAACP,KAAK,EAAE,IAAI,CAACC,QAAQ,CAAC;QACxF,MAAMQ,IAAG,GAAID,cAAc,CAACC,IAAI;QAEhC,MAAMC,UAAS,GAAId,GAAG,CAACE,EAAE,EAAE,OAAO,EAAEW,IAAI,CAACE,GAAG,CAAC;QAC7C,MAAMC,WAAU,GAAI,MAAMf,MAAM,CAACa,UAAU,CAAC;QAE5C,IAAI,CAACE,WAAW,CAACC,MAAM,CAAC,CAAC,EAAE;UACvB,MAAMlB,OAAO,CAACY,IAAI,CAAC;UACnB,IAAI,CAACO,SAAS,CAAC,0BAA0B,CAAC;QAC9C,OAAO;UACH,IAAI,CAACC,MAAM,CAACC,QAAQ,CAAC,cAAc,CAAC;UACpC,IAAI,CAACC,OAAO,CAACC,IAAI,CAAC,OAAO,CAAC;QAC9B;MACJ,EAAE,OAAOC,KAAK,EAAE;QACZ;QACA,IAAI,CAACL,SAAS,CAAC,0BAA0B,CAAC;MAC9C;IACJ,CAAC;IACDA,SAASA,CAACM,OAAO,EAAE;MACf,IAAI,CAAClB,YAAW,GAAIkB,OAAO;MAC3B,IAAI,CAACjB,YAAW,GAAIkB,UAAU,CAAC,MAAM;QACjC,IAAI,CAACnB,YAAW,GAAI,EAAE;MAC1B,CAAC,EAAE,IAAI,CAAC;IACZ,CAAC;IACDoB,SAASA,CAACC,GAAG,EAAE;MACX,IAAI,CAACN,OAAO,CAACC,IAAI,CAAC,GAAE,GAAIK,GAAG,CAACC,WAAW,CAAC,CAAC,CAAC;IAC9C;EACJ,CAAC;EACDC,QAAQ,EAAE;IACNC,QAAQA,CAAA,EAAG;MACb,OAAO,IAAI,CAACX,MAAM,CAACY,KAAK,CAACD,QAAQ;IACnC;EACA;AACJ"},"metadata":{},"sourceType":"module","externalDependencies":[]}