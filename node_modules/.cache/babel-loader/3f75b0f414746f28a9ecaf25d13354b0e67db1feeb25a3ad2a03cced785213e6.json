{"ast":null,"code":"import { createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, vModelText as _vModelText, withDirectives as _withDirectives, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = {\n  class: \"content\"\n};\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"p\", {\n  class: \"title\"\n}, \"Sign In\", -1 /* HOISTED */);\nconst _hoisted_3 = {\n  class: \"form_input_container\"\n};\nconst _hoisted_4 = {\n  class: \"form_input\"\n};\nconst _hoisted_5 = {\n  class: \"form_input_container\"\n};\nconst _hoisted_6 = {\n  class: \"form_input\"\n};\nconst _hoisted_7 = /*#__PURE__*/_createElementVNode(\"p\", null, [/*#__PURE__*/_createElementVNode(\"input\", {\n  class: \"button\",\n  type: \"submit\",\n  value: \"Log In\"\n})], -1 /* HOISTED */);\nconst _hoisted_8 = {\n  class: \"error-container\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_hoisted_2, _createElementVNode(\"form\", {\n    onSubmit: _cache[3] || (_cache[3] = _withModifiers((...args) => $options.login && $options.login(...args), [\"prevent\"]))\n  }, [_createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"p\", {\n    class: _normalizeClass([\"form_text\", {\n      dark: $options.darkMode\n    }])\n  }, \"Email\", 2 /* CLASS */), _createElementVNode(\"div\", _hoisted_4, [_withDirectives(_createElementVNode(\"input\", {\n    style: {\n      \"padding-left\": \"10px\"\n    },\n    type: \"email\",\n    name: \"email\",\n    id: \"email\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.email = $event),\n    class: _normalizeClass([\"form_input\", {\n      dark: $options.darkMode\n    }]),\n    placeholder: \"Enter email adress\"\n  }, null, 2 /* CLASS */), [[_vModelText, $data.email]])])]), _createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"p\", {\n    class: _normalizeClass([\"form_text\", {\n      dark: $options.darkMode\n    }])\n  }, \"Password\", 2 /* CLASS */), _createElementVNode(\"div\", _hoisted_6, [_withDirectives(_createElementVNode(\"input\", {\n    style: {\n      \"padding-left\": \"10px\"\n    },\n    type: \"password\",\n    name: \"password\",\n    id: \"password\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.password = $event),\n    class: _normalizeClass([\"form_input\", {\n      dark: $options.darkMode\n    }]),\n    placeholder: \"Enter password\"\n  }, null, 2 /* CLASS */), [[_vModelText, $data.password]])])]), _hoisted_7, _createElementVNode(\"p\", {\n    class: \"redirect-text\",\n    onClick: _cache[2] || (_cache[2] = $event => $options.changeTab('Sign-Up'))\n  }, \"Don't have an account ?\"), _createElementVNode(\"div\", _hoisted_8, [$data.errorMessage ? (_openBlock(), _createElementBlock(\"p\", {\n    key: 0,\n    class: _normalizeClass(['error-message', {\n      'visible': $data.errorMessage\n    }])\n  }, _toDisplayString($data.errorMessage), 3 /* TEXT, CLASS */)) : _createCommentVNode(\"v-if\", true)])], 32 /* HYDRATE_EVENTS */)]);\n}","map":{"version":3,"names":["class","_createElementVNode","type","value","_createElementBlock","_hoisted_1","_hoisted_2","onSubmit","_cache","_withModifiers","args","$options","login","_hoisted_3","_normalizeClass","dark","darkMode","_hoisted_4","style","name","id","$data","email","$event","placeholder","_hoisted_5","_hoisted_6","password","_hoisted_7","onClick","changeTab","_hoisted_8","errorMessage"],"sources":["/Users/quentin/Family-Tree/src/views/SignIn.vue"],"sourcesContent":["<template>\n    <div class=\"content\">\n        <p class=\"title\">Sign In</p>\n        <form @submit.prevent=\"login\">\n            <div class=\"form_input_container\">\n                <p class=\"form_text\" :class=\"{ dark: darkMode }\">Email</p>\n                <div class=\"form_input\">\n                    <input \n                        style=\"padding-left:10px\" \n                        type=\"email\" \n                        name=\"email\" \n                        id=\"email\" \n                        v-model=\"email\" \n                        class=\"form_input\"\n                        placeholder=\"Enter email adress\"\n                        :class=\"{ dark: darkMode }\"\n                    >\n                </div>\n            </div>\n            <div class=\"form_input_container\">\n                <p class=\"form_text\" :class=\"{ dark: darkMode }\">Password</p>\n                <div class=\"form_input\">\n                    <input \n                        style=\"padding-left:10px\" \n                        type=\"password\" \n                        name=\"password\" \n                        id=\"password\" \n                        v-model=\"password\" \n                        class=\"form_input\"\n                        placeholder=\"Enter password\"\n                        :class=\"{ dark: darkMode }\"\n                    >\n                </div>\n            </div>\n            <p><input class=\"button\" type=\"submit\" value=\"Log In\"></p>\n            <p class=\"redirect-text\" @click=\"changeTab('Sign-Up')\">Don't have an account ?</p>\n            <div class=\"error-container\">\n                <p :class=\"['error-message', { 'visible': errorMessage }]\" v-if=\"errorMessage\">{{ errorMessage }}</p>\n            </div>\n        </form>\n    </div>\n</template>\n\n<script>\nimport { getAuth, signInWithEmailAndPassword, signOut } from \"firebase/auth\";\nimport { doc, getDoc } from \"firebase/firestore\";\nimport { db } from \"../firebaseConfig\";\n\nexport default {\n    data() {\n        return {\n            email: '',\n            password: '',\n            errorMessage: '',\n            errorTimeout: null\n        }\n    },\n    methods: {\n        async login() {\n            this.errorMessage = '';\n            if (this.errorTimeout) {\n                clearTimeout(this.errorTimeout);\n            }\n\n            const auth = getAuth();\n            try {\n                const userCredential = await signInWithEmailAndPassword(auth, this.email, this.password);\n                const user = userCredential.user;\n\n                const userDocRef = doc(db, \"users\", user.uid);\n                const userDocSnap = await getDoc(userDocRef);\n\n                if (!userDocSnap.exists()) {\n                    await signOut(auth);\n                    this.showError(\"Unrecognized credentials\");\n                } else {\n                    this.$store.dispatch('fetchMembers');\n                    this.$router.push('/home');\n                }\n            } catch (error) {\n                // For security, show a generic message for most login errors\n                this.showError(\"Unrecognized credentials\");\n            }\n        },\n        showError(message) {\n            this.errorMessage = message;\n            this.errorTimeout = setTimeout(() => {\n                this.errorMessage = '';\n            }, 5000);\n        },\n        changeTab(tab) {\n            this.$router.push('/' + tab.toLowerCase());\n        }\n    },\n    computed: {\n        darkMode() {\n      return this.$store.state.darkMode;\n    }\n    }\n}\n</script>\n\n<style>\n.redirect-text {\n    font-weight:bold;\n    cursor:pointer;\n}\n\n.redirect-text:hover {\n    text-decoration: underline;\n}\n\n.error-container {\n    height: 20px; /* Reserve space to prevent layout shift */\n    margin-top: 10px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n\n.error-message {\n    color: red;\n    font-weight: bold;\n    opacity: 0;\n    visibility: hidden;\n    transition: opacity 0.5s ease, visibility 0s linear 0.5s;\n}\n\n.error-message.visible {\n    opacity: 1;\n    visibility: visible;\n    transition: opacity 0.5s ease;\n}\n</style>"],"mappings":";;EACSA,KAAK,EAAC;AAAS;gCAChBC,mBAAA,CAA4B;EAAzBD,KAAK,EAAC;AAAO,GAAC,SAAO;;EAEfA,KAAK,EAAC;AAAsB;;EAExBA,KAAK,EAAC;AAAY;;EAatBA,KAAK,EAAC;AAAsB;;EAExBA,KAAK,EAAC;AAAY;gCAa3BC,mBAAA,CAA0D,Y,aAAvDA,mBAAA,CAAmD;EAA5CD,KAAK,EAAC,QAAQ;EAACE,IAAI,EAAC,QAAQ;EAACC,KAAK,EAAC;;;EAExCH,KAAK,EAAC;AAAiB;;uBAnCpCI,mBAAA,CAuCM,OAvCNC,UAuCM,GAtCFC,UAA4B,EAC5BL,mBAAA,CAoCO;IApCAM,QAAM,EAAAC,MAAA,QAAAA,MAAA,MAAAC,cAAA,KAAAC,IAAA,KAAUC,QAAA,CAAAC,KAAA,IAAAD,QAAA,CAAAC,KAAA,IAAAF,IAAA,CAAK;MACxBT,mBAAA,CAcM,OAdNY,UAcM,GAbFZ,mBAAA,CAA0D;IAAvDD,KAAK,EAAAc,eAAA,EAAC,WAAW;MAAAC,IAAA,EAAiBJ,QAAA,CAAAK;IAAQ;KAAI,OAAK,kBACtDf,mBAAA,CAWM,OAXNgB,UAWM,G,gBAVFhB,mBAAA,CASC;IARGiB,KAAyB,EAAzB;MAAA;IAAA,CAAyB;IACzBhB,IAAI,EAAC,OAAO;IACZiB,IAAI,EAAC,OAAO;IACZC,EAAE,EAAC,OAAO;+DACDC,KAAA,CAAAC,KAAK,GAAAC,MAAA;IACdvB,KAAK,EAAAc,eAAA,EAAC,YAAY;MAAAC,IAAA,EAEFJ,QAAA,CAAAK;IAAQ;IADxBQ,WAAW,EAAC;0CAFHH,KAAA,CAAAC,KAAK,E,OAO1BrB,mBAAA,CAcM,OAdNwB,UAcM,GAbFxB,mBAAA,CAA6D;IAA1DD,KAAK,EAAAc,eAAA,EAAC,WAAW;MAAAC,IAAA,EAAiBJ,QAAA,CAAAK;IAAQ;KAAI,UAAQ,kBACzDf,mBAAA,CAWM,OAXNyB,UAWM,G,gBAVFzB,mBAAA,CASC;IARGiB,KAAyB,EAAzB;MAAA;IAAA,CAAyB;IACzBhB,IAAI,EAAC,UAAU;IACfiB,IAAI,EAAC,UAAU;IACfC,EAAE,EAAC,UAAU;+DACJC,KAAA,CAAAM,QAAQ,GAAAJ,MAAA;IACjBvB,KAAK,EAAAc,eAAA,EAAC,YAAY;MAAAC,IAAA,EAEFJ,QAAA,CAAAK;IAAQ;IADxBQ,WAAW,EAAC;0CAFHH,KAAA,CAAAM,QAAQ,E,OAO7BC,UAA0D,EAC1D3B,mBAAA,CAAkF;IAA/ED,KAAK,EAAC,eAAe;IAAE6B,OAAK,EAAArB,MAAA,QAAAA,MAAA,MAAAe,MAAA,IAAEZ,QAAA,CAAAmB,SAAS;KAAa,yBAAuB,GAC9E7B,mBAAA,CAEM,OAFN8B,UAEM,GAD+DV,KAAA,CAAAW,YAAY,I,cAA7E5B,mBAAA,CAAqG;;IAAjGJ,KAAK,EAAAc,eAAA;MAAA,WAAiCO,KAAA,CAAAW;IAAY;sBAA4BX,KAAA,CAAAW,YAAY,2B"},"metadata":{},"sourceType":"module","externalDependencies":[]}